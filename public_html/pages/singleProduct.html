<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sparkle Collections</title>
    <!-- Link to Bootstrap CSS -->
    <link rel="stylesheet" href="../css/bootstrap.min.css" />
    <!-- Link to Bootstrap Icons -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
      <!-- Link to your CSS files -->
      <link rel="stylesheet" href="../css/style.css">
</head>
<body>
      <!-- First Navbar (div for logo, sign-in, and cart icons) -->
      <div class="container first-navbar">
        <div class="d-flex justify-content-between align-items-center">
            <!-- Logo -->
            <a class="navbar-brand" href="#" style="font-size: 30px; color: #888;">Sparkle Collections</a>

            <!-- Sign in, favorites, and cart icons -->
            <div class="d-flex align-items-center">
                <a class="nav-link" href="./login.html" style="font-size: 20px; color: #888;"><i class="bi bi-person-fill"></i> Sign in</a>
                <a class="nav-link" href="#" style="font-size: 20px; color: #888;"><i class="bi bi-heart-fill"></i></a>
                <a class="nav-link" href="#" style="font-size: 20px; color: #888;"><i class="bi bi-cart-fill"></i></a>
            </div>
        </div>
    </div>
    <!-- Second Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light second-navbar">
      <div class="container">
        <!-- Navbar Toggler Button -->
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navbar Links -->
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mx-auto">
            <!-- Dropdown Menu Items -->
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown1"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
                >Clothing</a
              >
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown1">
                .
                <li><a class="dropdown-item" href="#">Men's Clothing</a></li>
                <li><a class="dropdown-item" href="#">Women's Clothing</a></li>
                <li><a class="dropdown-item" href="#">Kids Clothing</a></li>
                <li><a class="dropdown-item" href="#">Sportswear</a></li>
              </ul>
            </li>
            <!-- Add more dropdown items as needed -->
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown2"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
                >Shoes</a
              >
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown2">
                <li><a class="dropdown-item" href="#">Sneakers</a></li>
                <li><a class="dropdown-item" href="#">Boots</a></li>
                <li><a class="dropdown-item" href="#">Sandals</a></li>
                <li><a class="dropdown-item" href="#">High Heels</a></li>
                <li><a class="dropdown-item" href="#">Slippers</a></li>
              </ul>
            </li>
            <!-- Add more dropdown items as needed -->
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown3"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
                >Accessories</a
              >
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown3">
                <li><a class="dropdown-item" href="#">Bags</a></li>
                <li><a class="dropdown-item" href="#">Hats</a></li>
                <li><a class="dropdown-item" href="#">Belts</a></li>
                <li><a class="dropdown-item" href="#">Scarves</a></li>
                <li><a class="dropdown-item" href="#">Jewelry</a></li>
              </ul>
            </li>
            <!-- Add more dropdown items as needed -->
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown4"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
                >Exclusive Items</a
              >
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown4">
                <li><a class="dropdown-item" href="#">Limited Edition</a></li>
                <li>
                  <a class="dropdown-item" href="#">Designer Collection</a>
                </li>
                <li><a class="dropdown-item" href="#">Luxury Items</a></li>
                <li>
                  <a class="dropdown-item" href="#">Customized Products</a>
                </li>
              </ul>
            </li>
            <!-- Add more dropdown items as needed -->
          </ul>
        </div>
      </div>
    </nav>

    <!-- Product Content -->
    <div class="container my-2">
        <hr class="py-3">
        <div class="row">
            <!-- Small Images Column (Hidden on Small Screens) -->
            <div class="col-md-2 d-none d-md-block">
                <div class="small-images row" id="small_images">
                
                </div>
            </div>
            <!-- Large Image Column -->
            <div class="col-md-6">
                <!-- Large product image -->
                <div class="large-image">
                    <img src="" alt="Large Image" id="largeImage" class="img-fluid">
                </div>
            </div>
         <!-- Product Description Column -->
        <div class="col-md-4 mt-sm-4">
            <div class="product-description">
                <!-- Product Name -->
                <h2></h2>
                <p></p>
                <!-- Star Rating -->
                <div class="rating py-2">
                    <!-- Rating stars or other rating component -->
                    <p class="" id="rating">

                    </p>
                </div>
            
                <!-- Size Selection Option -->
                <div class="form-group">
                    <label for="size">Select Size:</label>
                    <select class="form-control" id="size">
                        <!-- <option>Small</option>
                        <option>Medium</option>
                        <option>Large</option> -->
                    </select>
                </div>
            
                <!-- Color Selection Option -->
                <div class="form-group">
                    <label for="color">Select Color:</label>
                    <select class="form-control" id="color">
                        <!-- <option>Red</option>
                        <option>Blue</option>
                        <option>Green</option> -->
                    </select>
                </div>
            
                <!-- Second Row: Product Details -->
                <div class="mt-3">
                    <div class="py-3 border-bottom">
                        <!-- About This Item -->
                        <h5>About This Item</h5>
                        <!-- <p>Description of the product goes here. Description of the product goes here. Description of the product goes here.</p> -->
                    </div>
                    <div class="pt-4">
                        <!-- Product Details -->
                        <h5>Product Details</h5>
                        <ul>
                            <!-- <li>Material: Cotton</li>
                            <li>Fit: Regular</li>
                            <li>Model Height: 5'8"</li> -->
                        </ul>
                    </div>
                    <!-- Quantity Selection -->
                    <div class="form-group">
                        <label for="quantity">Quantity:</label>
                        <div class="input-group">
                            <button id="decreaseBtn" class="btn btn-outline-secondary" type="button">-</button>
                            <input type="number" class="form-control text-center" id="quantity"value="1" placeholder="1" min="1">
                            <button id="increaseBtn" class="btn btn-outline-secondary" type="button">+</button>
                        </div>
                    </div>

                    <div class="d-flex justify-content-end align-items-center">
                        <p class="text-end" id="price"></p>
                    </div>

                </div>
            
                <!-- Button to add to cart -->
                <div class="d-flex justify-content-center align-items-center">
                    <button onclick="addToCartAndOpenModal(this.parentNode.parentNode.parentNode, productId)" class="btn btn-primary mt-3" style="background-color: black; width: 100%; padding: 16px; color: white;">Add to Cart</button>
                </div>
            </div>
        </div>
        </div>
    </div>

    <!-- Featured Products Section -->
    <hr>
    <div class="container mt-5">
        <h2 class="text-start mb-4">Featured Products</h2>
        <div class="row" id="featuredProducts">

        </div>
    </div>
    <!-- Footer -->
    <footer class="footer mt-5 bg-dark text-white ">
       <div class="container py-4">
           <div class="row">
               <!-- Column 1: Logo, Sparkle Collections, Contact us, Our store -->
               <div class="col-md-3">
                   <h5 class="mb-3">Sparkle Collections</h5>
                   <p>Contact us</p>
                   <p>Our store</p>
               </div>
               <!-- Column 2: Speak to our representatives -->
               <div class="col-md-3">
                <h5 class="mb-2">Speak to our representatives</h5>
                <form>
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" placeholder="Enter your message">
                        <div class="input-group-append">
                            <button type="submit" class="btn btn-primary" style="width: 48px;">Submit</button>
                        </div>
                    </div>
                </form>
            </div>            
               <!-- Column 3: Follow us on social media -->
               <div class="col-md-3">
                   <h5 class="mb-2">Follow us on</h5>
                   <ul class="list-unstyled">
                       <li class="pr-2">Twitter<i class="bi bi-twitter"></i></li>
                       <li class="pr-2">Instagram <i class="bi bi-instagram"></i></li>
                       <li class="pr-2">Facebook <i class="bi bi-facebook"></i></li>
                       <li class="pr-2">Pinterest <i class="bi bi-pinterest"></i></li>
                       <li class="pr-2">TikTok  <i class="bi bi-tiktok"></i></li>
                   </ul>
               </div>
               <!-- Column 4: Privacy and policies -->
               <div class="col-md-3">
                   <h5 class="mb-2">Privacy and policies</h5>
                   <p>Privacy Policy</p>
                   <p>Terms of Service</p>
               </div>
        </div>
    </div>
    </footer>

    <!-- Copyright -->
    <div class="container-fluid text-center bg-dark text-white py-3">
        <p>&copy; 2024 Sparkle Collections. All Rights Reserved.</p>
    </div>
<!-- Modal -->
<div class="modal fade" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-right"> <!-- Add modal-right class -->
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cartModalLabel">Shopping Cart (<span id="cartItemCount">0</span> items)</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="cartModalBody">
                <!-- Cart items will be dynamically added here -->
            </div>
            <div class="modal-footer d-flex flex-column">
                <div class="mb-2 w-100">
                    <button id="btn-continue" type="button" class="btn btn-primary w-100 " data-dismiss="modal" style="padding: 10px; background-color: black; font-size: 18px; color: white; border: black;">Continue Shopping</button>
                </div>
                <div class="w-100">
                   <a href="http://localhost:3000/pages/cart.html">

                       <button id="btn-checkout" class="btn btn-primary w-100" style="padding: 10px; background-color: white; font-size: 18px; color: black; border: 1px solid black">Proceed to Checkout</button>
                   </a> 
                </div>
            </div>
        </div>
    </div>
</div>

    <!-- Link to jQuery, Popper.js, and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script src="../js/popper.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/singleProduct.js"></script>
    <script src="../js/singleProductApi.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Get the product ID from the URL query parameter
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');
    
            // Fetch the product details from the backend API
            fetch(`http://localhost:3000/api/products/${productId}`)
                .then(response => response.json())
                .then(product => {
                    // Populate the product content with the fetched data
                    const productName = document.querySelector('.product-description h2');
                    productName.textContent = product.name;
    
                    // Update the "Add to Cart" button to pass productId, productName, and quantity
                    const addToCartButton = document.querySelector('.btn-primary');
                    addToCartButton.onclick = function() {
                        const productContainer = document.querySelector('.product-description');
                        const quantityInput = document.getElementById('quantity');
                        const quantity = parseInt(quantityInput.value);
                        addToCartAndOpenModal(product, quantity);
                    };
    
                    // Your existing code continues...
                })
                .catch(error => {
                    console.error('Error fetching product details:', error);
                });
        });
    
        function addToCartAndOpenModal(product, quantity) {
            // Add the product to the cart
            addToCart(product, quantity);
    
            // Open the modal
            $('#cartModal').modal('show');
            const items_count=document.getElementById('cartItemCount');
            items_count.textContent=quantity;
            // Update the modal body to display the added product
            const modalBody = document.querySelector('.modal-body');
            const productDetails = `
                    <div class="row">
                        <!-- Column 1: Product Image -->
                        <div class="col-md-4">
                            <img src="${product.images[0]}" class="img-fluid" alt="Product Image">
                        </div>
                        <!-- Column 2: Product Name and Quantity -->
                        <div class="col-md-4">
                            <p>Name: ${product.name}</p>
                            <p>Quantity: ${quantity}</p>
                            <!-- Add more product details here as needed -->
                        </div>
                        <!-- Column 3: Price -->
                        <div class="col-md-4">
                            <p>Total Price: $${product.current_price * quantity}</p>
                        </div>
                    </div>
                `;
                
            modalBody.innerHTML = productDetails;
        }
    
        function addToCart(product, quantity) {
            // Log the product data being added to the cart
            console.log('Adding product to cart:', product);
            const id  = product._id;
    
            // Send a POST request to the endpoint to add the product to the cart
            fetch('http://localhost:3000/api/cart/add', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(
                    {
                        productId: id,
                        quantity: quantity
                    }
                ),
            })
            .then(response => {
                if (response.ok) {
                    // Show success message or update UI
                    console.log('Product added to cart successfully');
                } else {
                    // Handle errors or show error message
                    console.error('Error adding product to cart');
                }
            })
            .catch(error => {
                console.error('Error adding product to cart:', error);
            });
        }

    </script>
    
  
</body>
</html>
